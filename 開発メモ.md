# 開発メモ

## 初日
## leaflet実装調査

* 最初mapの読み込みにてこずった  
'https://qiita.com/aKuad/items/be450ce65359a3e94820'

* markerのクリック時参考にしたサイト  
'https://www.achiachi.net/blog/leaflet/clickevent?do=edit'

* javascriptでURL遷移する方法  
'https://qiita.com/shuntaro_tamura/items/99adbe51132e0fb3c9e9'

* 右クリックでメニューを登録する方法  
'https://kita-note.com/leaflet-plugin-contextmenu'

## 2日目
## テーブル定義設計

* 後で保守しやすいように可能な限り正規化していく  →テーブル定義作ってER図作ってから正規化検討する

* 住所はどのように分割するべきか

* 郵便番号は何桁？？
アメリカの最大9桁が最大っぽい
https://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1136241301

* 全世界の住所検索
geonamesが利用できそう
'http://www.geonames.org/'

* 予定通り一旦作成完了.

## 午後（開発環境作成FLASKアプリ立ち上げまで)

* kaliのIP：192.168.11.128

* VSCODEでSSH接続 to kali
→マニュアルをきちんと呼んでいなくて結構時間かかってしまった。

* コンテナを作っていく。
→道が長そうなのでもう少しタスク分割して計画立てる

* Gitlabでissue登録
    * 一括インポートするときは、フォーマット統一する必要あり。(カラムはtitleとdescriptionだけ？？)
    *登録後一括編集できるが、期限は一括編集できないので、事前にインポートで登録できると便利
    *時間管理がしずらいなと思ったけど。1単位あたりのタスクを1H~2Hになるように登録できれば逆算ができるし、
    単位としてもちょうどいいので便利かも

    https://qiita.com/jumpyoshim/items/d5a63bdd3681843866f8
    https://docs.gitlab.co.jp/ee/user/project/issues/csv_import.html#csv-file-format

    エクスポートのページにカラム名あり、これでインポートできそう！！
    https://docs.gitlab.co.jp/ee/user/project/issues/csv_export.html

* スケジュールの見直しを。特に基盤部分

## 3日目

* タスクを整理
    * gitlabでtimetrackingを利用してスケジュール管理できるので便利  
      issueごとに/estimate 1h /spend 1hみたいにすることで予実管理が
      簡単にできる

* dockerコンテナ上にmysqlを永続化

    * これを参考にしようかな
    'https://qiita.com/leafeon00000/items/e190cf92af3a487cc749'
    
    ボリュームについて
    https://zenn.dev/eitches/articles/2021-0320-docker-
    

    ```
    ├── docker-compose.yml
    └── mysql
        ├── Dockerfile
        ├── db　←最初は空（フォルダのみ作成）
        │   └──（永続化のためのファイル等省略）
        ├── initdb.d
        │   └── init.sql
        └── my.cnf
    ```

    * まずはディレクトリ構成をgit上で作成する

        *永続化したDBはどこに配置するのがよいか（マウント先）

        というかデータの管理についてよく理解できない部分があり、
        slackで質問した。

        ```
        お忙しいところ失礼いたします。1点質問させてください。
        Dockerのコンテナ上にmysqlを立ち上げようとしています。
        登録したデータの管理に関して、以下認識であっておりますでしょうか。
            ・コンテナ内のディレクトリにDBデータ自体も登録する。（kaliのゲストOSのディレクトリにマウントしない）
            ・AnsibleでCentOSにデプロイする際は、DBデータも含んだ形でDocker imageを作成し、centOS上でpullし、コンテナ起動する形とする。
        そもそもの理解が間違っている気もしています。
        開発環境で登録したmysqlをどのようにcentOS上に移行するのかについてご意見いただきたいです。
        それとも、CentOS側にmysqlを立ち上げたあとにデータ移行が必要でしょうか？
        ```

        →データ移行が必要という解答。確かにその通りだ。
         解答：私の場合はこうしてました。
            1. データをcsvで持っておき、一つのフォルダにまとめておく
            2. CREATE TABLEやデータロードをするSQLを実行してくれるシェルスクリプトを書く
            3. １と２をコンテナ側にマウントし、Dockerfileで起動時に２を実行する文を書いておく


        dumpを取得してインポートするという手段もありそう。
        https://prograshi.com/platform/database/inport-dump-file-in-docker/

        *mysqlのDockerfileを作成していく

        Dockerのディレクトリ構成って？？
        うまく言語かできないんだけど、コンテナのOSってどうなるのってところ。違うのか。mysqlだけのコンテナは、
        kali側の構成を探しにいくのか。だとしたらcentosにデプロイするときはディレクトリ構成を気を付けないと。
        https://tech-lab.sios.jp/archives/21103


## 参考
* APIBank  
'https://www.apibank.jp/ApiBank/api?category_no=41'
